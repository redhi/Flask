{% extends "Base.html" %}

{% block page_content %}

{% if book_info %}
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<div class="plusimg">
    <img class="detail-img" src="../../../{{book_info.link}}">

    <div class="book_info">
        <p>책이름: {{ book_info.book_name }}</p>
        <p>출판사: {{ book_info.publisher }}</p>
        <p>저자: {{ book_info.author }}</p>
        <p>출간일: {{ book_info.publication_date }}</p>
        <p>페이지 수: {{ book_info.pages }}</p>
        <p>ISBN 코드: {{ book_info.isbn }}</p>
    </div>
</div>
<hr>
<div class="total-description">
    <h2>책 소개</h2>
    <div class="book-description">
        <p>{{ book_info.description }}</p>
    </div>
</div>
<hr>
<div class="review">
    <h2>댓글</h2>
    <div class="review-now">현재 {{ review_info|length }} 개의 댓글 있습니다.</div>
    {% for review in review_info %}
    {%if review.id == review_id%}
    <form
        action="{{ url_for('detail.modify_review2',book_id=book_id, review_id=review_id,nowrate=nowrate, ratenum=ratenum)  }}"
        method="post">
        <div class="form-group">
            <label for="review">댓글</label>
            <input class="form-control" name="review" id="review" placeholder="{{book.content}}"></input>
        </div>
        <div class="star-btn">
            <div class="star-rating">
                <input type="radio" id="5-stars" name="rating" value="5" v-model="ratings" />
                <label for="5-stars" class="star pr-4">★</label>
                <input type="radio" id="4-stars" name="rating" value="4" v-model="ratings" />
                <label for="4-stars" class="star">★</label>
                <input type="radio" id="3-stars" name="rating" value="3" v-model="ratings" />
                <label for="3-stars" class="star">★</label>
                <input type="radio" id="2-stars" name="rating" value="2" v-model="ratings" />
                <label for="2-stars" class="star">★</label>
                <input type="radio" id="1-star" name="rating" value="1" v-model="ratings" />
                <label for="1-star" class="star">★</label>
            </div>
            <input class="btn btn-primary" type="submit" value="작성하기">
        </div>
    </form>
    {%else%}
    <div class="review-user">
        <p> {{review.user_name}}</p>
        <div class="star-ratings">
            <div class="star-ratings-fill space-x-2 text-lg" style="width:{{review.rating*20+1.5}}%">
                <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span>
            </div>
            <div class="star-ratings-base space-x-2 text-lg">
                <span>★</span><span>★</span><span>★</span><span>★</span><span>★</span>
            </div>
        </div>
        <span>
            {{ review.rating }}</span> {{ review.content }}
        {{review.create_time}}
        {% if session['email'] == review.user_id %}
        <!--bookReview에 user_id 추가해주기!!!!!!-->
        <a class="btn btn-danger btn-sm"
            href="{{ url_for('detail.modify_review', book_id=book_info.id, review_id=review.id)}}">수정</a>
        <a class="btn btn-danger btn-sm"
            href="{{ url_for('detail.delete_review', book_id=book_info.id, review_id=review.id)}}">삭제</a>

        {%endif%}
        </p>
    </div>
    {%endif%}
    {% endfor %}
</div>
{%endif%}



<hr>
<div class="write-review">
    {% if session['email'] %}
    <h2>댓글 작성</h2>
    <!--아래도 id를 user_id로!!!!!!!!!-->
    <form action="{{ url_for('detail.create_review', book_id=book_info.id) }}" method="post">
        <div class="form-group">
            <label for="review">댓글</label>
            <input class="form-control" name="review" id="review" placeholder="댓글을 작성해주세요."></input>
        </div>
        <div class="star-btn">
            <div class="star-rating">
                <input type="radio" id="5-stars" name="rating" value="5" v-model="ratings" />
                <label for="5-stars" class="star pr-4">★</label>
                <input type="radio" id="4-stars" name="rating" value="4" v-model="ratings" />
                <label for="4-stars" class="star">★</label>
                <input type="radio" id="3-stars" name="rating" value="3" v-model="ratings" />
                <label for="3-stars" class="star">★</label>
                <input type="radio" id="2-stars" name="rating" value="2" v-model="ratings" />
                <label for="2-stars" class="star">★</label>
                <input type="radio" id="1-star" name="rating" value="1" v-model="ratings" />
                <label for="1-star" class="star">★</label>
            </div>
            <input class="btn btn-primary" type="submit" value="작성하기">
        </div>
    </form>
    {% endif %}
</div>
{% endblock %}